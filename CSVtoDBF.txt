
Процедура КнопкаВыполнитьНажатие(Кнопка)
	//Чтение из файла
	Табель    = Новый Массив();
	ИИН       = Новый Массив();
	Фамилия   = Новый Массив();
	Имя       = Новый Массив();
    КартСчет  = Новый Массив();
	
	//ФайлЗагрузки         = Новый ЧтениеТекста("D:\Текстовый файл.txt");
	//ВесьФайлОднойСтрокой = Файл.Прочитать();
	//					   //ПрочитатьФайл(ФайлЗагрузки);
	//ФайлЗагрузки         = "D:\КартСчета\CSV.BDF";
	//ФайлЗагрузки.Закрыть();
	
	мСтрокФайла = Новый Массив();
	Файл = Новый ТекстовыйДокумент;
	Файлик =   "D:\КартСчета\dbf.csv";
	Файл.Прочитать(Файлик);
	
	А=А;
	
	Для й = 1 По Файл.КоличествоСтрок() Цикл
		мСтрокФайла.Добавить(Файл.ПолучитьСтроку(й));	
	КонецЦикла;
	
//	Файл.ЗакрытьФайл();
	
	//Запись в файл
	ДБФ = Новый XBase;
	//TAB_N	IIN	LAST_NAME	FIRST_NAME	OTCHESTVO	KART_SCHET

	 ДБФ.Поля.Добавить("TAB_N","S", 10);
	 ДБФ.Поля.Добавить("IIN"  ,"S", 12);
	 ДБФ.Поля.Добавить("LAST_NAME"   ,"S", 50);
	 ДБФ.Поля.Добавить("FIRST_NAME"  ,"S", 35);
	 ДБФ.Поля.Добавить("OTCHESTVO"   ,"S", 50);
	 ДБФ.Поля.Добавить("KART_SCHET"  ,"S", 20); 
	 ДБФ.СоздатьФайл("D:\КартСчета\KartA.BDF");

	Для Каждого ЭлементМассива Из мСтрокФайла Цикл
	ДБФ.Добавить();
	
		Сообщить(ЭлементМассива);
		ДлинаСтроки      = СтрДлина(ЭлементМассива);
		ПолучПоз         = Найти(ЭлементМассива,";");
		Табельный        = Лев(ЭлементМассива, ПолучПоз-1);
		ЭлементМассива   = Сред(ЭлементМассива,ПолучПоз+1,ДлинаСтроки-ПолучПоз);
		ДБФ["TAB_N"]     = Табельный;
		
		ДлинаСтроки      = СтрДлина(ЭлементМассива);
		ПолучПоз         = Найти(ЭлементМассива,";");
		ИИН              = Лев(ЭлементМассива, ПолучПоз-1);
		ЭлементМассива   = Сред(ЭлементМассива,ПолучПоз+1,ДлинаСтроки-ПолучПоз);
		ДБФ["IIN"]       = ИИН;
		
		ДлинаСтроки      = СтрДлина(ЭлементМассива);
		ПолучПоз         = Найти(ЭлементМассива,";");
		Фамилия          = Лев(ЭлементМассива, ПолучПоз-1);
		ЭлементМассива   = Сред(ЭлементМассива,ПолучПоз+1,ДлинаСтроки-ПолучПоз);
		ДБФ["LAST_NAME"] = Фамилия;
		
		ДлинаСтроки      = СтрДлина(ЭлементМассива);
		ПолучПоз         = Найти(ЭлементМассива,";");
		Имя              = Лев(ЭлементМассива, ПолучПоз-1);
		ЭлементМассива   = Сред(ЭлементМассива,ПолучПоз+1,ДлинаСтроки-ПолучПоз);
		ДБФ["FIRST_NAME"]= Имя;
		
		ДлинаСтроки      = СтрДлина(ЭлементМассива);
		ПолучПоз         = Найти(ЭлементМассива,";");
		Отчество         = Лев(ЭлементМассива, ПолучПоз-1);
		ЭлементМассива   = Сред(ЭлементМассива,ПолучПоз+1,ДлинаСтроки-ПолучПоз);
		ДБФ["OTCHESTVO"] = Отчество;
		
		Счет             = ЭлементМассива;
		ДБФ["KART_SCHET"]= Счет;
		
	ДБФ.Записать();
	А=А;
	
	КонецЦикла;
	
	ДБФ.ЗакрытьФайл();	

КонецПроцедуры
